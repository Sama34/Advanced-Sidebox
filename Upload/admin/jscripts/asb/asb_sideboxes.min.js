var ASB=(function(h,c){function j(){c(".draggable").draggable({revert:true,start:function(k,a){a.helper.css("z-index",999)},stop:function(k,a){a.helper.css("z-index",50)}});c(".sortable").sortable({connectWith:".column",update:function(l,k){var a=c(this);c.ajax({type:"post",url:"index.php",data:{module:"config-asb",action:"xmlhttp",mode:"order",pos:a.prop("id"),data:a.sortable("serialize")},success:function(m){if(!m){return}if(typeof m=="string"&&m.search('value="login"')!=-1){location.reload(true)}var n=m.split(",");c(n).each(function(o,p){n[o]=parseInt(p)});e(n)},error:function(m,o,n){alert(o+"\n\n"+n)}})}}).disableSelection();c(".droppable").droppable({accept:".draggable",hoverClass:"hover",drop:d});c("a[id^='edit_sidebox_']").click(i);c(".del_icon").remove();c(".add_box_link").each(function(a,k){k.replaceWith(c(k).html())})}function i(a){a.preventDefault();g(c(this).prop("href")+"&ajax=1")}function d(l,k){var m=(c(this).prop("id")=="left_column")?0:1,a="index.php?module=config-asb&action=edit_box&ajax=1&box=0&addon="+k.draggable.prop("id")+"&pos="+m;g(a)}function g(a){c.get(a,function(k){if(!k||k.length==0){return}if(typeof k=="string"&&k.search("errors")!=-1&&k.search("login")!=-1){location.reload(true);return}c(k).appendTo("body").modal({fadeDuration:250,zIndex:(typeof modal_zindex!=="undefined"?modal_zindex:9999)})})}function f(l,k,a){if(!c("#"+a)){return}c("#"+a).append(c("<div/>",{id:"sidebox_"+l,"class":"sidebox"}).html(k))}function b(k){var a="#sidebox_"+k;if(!c(a)){return}c(a).load("index.php",{module:"config-asb",action:"xmlhttp",mode:"build_info",id:k,ajax:"1"})}function e(k){if(k.length==0){return}var a,m,l;for(a=0;a<k.length;a++){m="#sidebox_"+k[a];if(!c(m)){continue}l=c(m);l.css({backgroundColor:"#f00"});l.html(lang.deleting_sidebox);l.fadeOut(800,function(){c(this).remove()})}}c(j);h.sidebox={createDiv:f,updateDiv:b};return h})(ASB||{},jQuery);